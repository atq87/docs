---
uid: using-powershell
title: Deployment Through PowerShell
---
# Deployment Through PowerShell

For a walk-through of creating a BimlFlex solution that targets ADF, review the [Synapse ADF Implementation Guide](../implementation-guides/synapse-implementation-introduction.md).

You have generated your Azure Data Factory (ADF) assets, and are ready to deploy. This document will discuss deployment using ARM templates by using powershell. For information on how to deploy using the Azure Portal, review our [Azure Portal Deployment Guide](using-azure-portal.md).

## Prerequisites

You need to ensure that you have your **arm_template.json** and **arm_template_parameters.json** files in your project's output folder. The path will look like this: 
` ...\output\DataFactories\<Setting.AzureDataFactoryName>\arm_template.json`

> [!NOTE]
> If there is no value specified **BimlFlex** will be used for the folder name.  It is important to note though that the actual ADF Data Factory Name will be a something like `ADF-<RandomHashValue>`.  It is recommended that you populate the configure your `Settings` and input an [AzureDataFactoryName] prior to building your ADF.

## ARM Template Parameters File

[//]: # (TODO: Write a call-out as to how this file is used and what it is used for.)

**Example: arm_template_paramaters.json**
```json
{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "BimlFlexAutogeneratedKeyVaultSettings": {
      "value": {
        "keyVaultName": "ADF-281a7eeb2eb3d",
        "skuName": "Standard"
      }
    },
    "factoryName": {
      "value": "ADF-281a7eeb2eb3d"
    }
  }
}
```

[//]: # (TODO: Build a table of the the `Settings`, complete with the [Group Name] and [Key Name], that set and control the above `keyVaultName` and `factoryName` values.  Also reference that show above is a default name and if development and deployment is wanted to a single ADF, to THEN copy these values.  I believe it is important that we try to stress proper use of the `Settings` first and foremost though.)

## Generated Deployment Artifacts

[//]: # (TODO: Oultine deployment artifacts.  Include a reference to the folder structure '...\output\Deploy\` and file naming pattern `adf-deploy.<Setting.AzureDataFactoryName>`.  Execution should only need the running of the *.ps1 file and not manually running PowerShell commands.  Reference that the commented portion is provide to already generate the installation of the required cmdlet and the proper `Connect-AzAccount` syntax.  As above, highlight was settings control what output parameters to the users can correct any potential misconfiguration.  This should be a main text block in addition the the note below.)

> [!IMPORTANT]
> PowerShell, along with the appropriate cmdlets are required and used in the generated PowerShell script.  BimlFlex will automatically generate the commands needed to both install the cmdlets and connect to specified environment.  If further details on the commands generate are needed, or to generate these commands manually, refer the the article linked below.
> 
> Microsoft Docs:
> [<Install PowerShell Article Name>](atricleLink)  
> [Get started with Azure PowerShell](https://docs.microsoft.com/en-us/powershell/azure/get-started-azureps)  
> [Connect-AzAccount](https://docs.microsoft.com/en-us/powershell/module/az.accounts/connect-azaccount)  

[//]: # (TODO: Link to Microsoft Doc to install PowerShell in link above.)

## Deploying with Powershell

[//]: # (TODO: Not sure if this H2 section is needed.  Focus should be on using the script to streamline the process not manually creating and running the commands.  May be able to be refactored and used as the explanation of what `Setting` controls what value.)

In order to deploy your ARM template to your resource group, you need to use the following command:

```powershell
New-AzResourceGroupDeployment -Name <Name> -ResourceGroupName <YourResourceGroupName> -TemplateFile <arm_template.json path> -TemplateParameterFile <arm_template_parameters.json path>.json
```

|Property|Description|
|-|-|
|Name|The name of your deployment.|
|ResourceGroupName| The resource group that you would like to deploy the ADF assets to.|
|TemplateFile| The arm_template.json file path that we obtained earlier.|
|TemplateParameterFile| The arm_template_parameter.json file path that we obtained earlier.

Once the command is run the output should be similar to:

[//]: # (Not sure if `console` will work.  Have to test a build and see.  Just trying to improve code block formatting.)

```console
DeploymentName          : MyBimlFlexAdfDeployment
ResourceGroupName       : BimlFlexResourceGroup
ProvisioningState       : Succeeded
Timestamp               : 3/2/2020 10:52:29 AM
Mode                    : Incremental
TemplateLink            : 
Parameters              : 
                          Name                   Type                       Value     
                          =====================  =========================  ==========
                          dataFactoryName        String                     <data factory name>
                          dataFactoryLocation    String                     East US   
                          storageAccountName     String                     <storage account name>
                          storageAccountKey      SecureString                    
                          
Outputs                 : 
DeploymentDebugLogLevel : 
```

The deployment of the ADF assets using the Azure Portal should now be successful.  Pipeline(s) should now be able to be started to verify deployment inside the ADF Authoring Tool.

[//]: # (TODO: Link a Microsoft Doc on using the authoring tool similar to the way outlined above?)
