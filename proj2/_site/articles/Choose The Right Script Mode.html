<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title> </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content=" ">
    <meta name="generator" content="docfx 2.33.1.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
	  <div id="header">
	      <div class="container">
	          <button id="main-nav-toggle" type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu" aria-expanded="false" aria-controls="navbar">
	              <span class="sr-only">Toggle navigation</span>
	              <span class="icon-bar"></span>
	              <span class="icon-bar"></span>
	              <span class="icon-bar"></span>
	          </button>
	  
	          <li id="mobile-icon-search"><img class="header-search-icon" src="/Content/Images/icons/search.png"></li>
	  
	          <div class="logo-link">
	              <a href="/">
	                  <img id="site-logo" src="/Content/images/varigence-icon.png" alt="Varigence">
	              </a>
	          </div>
	  
	          <div id="mobile-search-area">
	              <div id="search-form">
	  <form action="/Search" method="get">                    <button type="submit" name="search" id="search-submit"><img src="/Content/Images/icons/search.png"></button>
	                      <input type="search" class="form-control input-sm" name="q" id="search" placeholder="Start Typing...">
	  </form>            </div>
	          </div>
	          <div id="main-menu" class="navbar-collapse collapse">
	              
	              <ul class="nav navbar-nav">
	      <div id="main-menu-triangle" class="triangle-up"></div>
	  
	      
	      
	      <li class=" direct"><a href="/Company">About Us</a></li>
	  
	      <li id="productstab" class="">
	      <a class="dropdown-link" href="/Products">Products<span class="arrow-down"><i class="fa fa-angle-down"></i></span></a>
	      <div class="menu-column-container">
	          <div id="menu-column-container-products" class="menu-container">
	  
	              <div class="mobile-menu">
	                  <ul>
	                      <li class="menu-item-header"><a href="/Products">Overview</a></li>
	                  </ul>
	                  <ul>
	                          <li><a href="/Biml">Biml</a></li>
	                                              <li><a href="/Mist">BimlStudio</a></li>
	                                              <li><a href="/BimlFlex">BimlFlex</a></li>
	                                              <li><a href="/BimlExpress">BimlExpress</a></li>
	                                              <li><a href="/BimlOnline">BimlOnline</a></li>
	                      
	                  </ul>
	  
	              </div>
	  
	              <div class="desktop-menu">
	                  <ul class="tab-control">
	                      <li class="menu-item-header direct"><a href="/Products" data-target="#overview-products-tab-pane" data-toggle="tab">Overview</a></li>
	                      
	                          <li class="menu-item-header active direct">
	                              <a href="/Biml" data-target="#biml-tab-pane" data-toggle="tab">Biml</a>
	                          </li>
	                                              <li class="menu-item-header direct">
	                              <a href="/Mist" data-target="#bimlstudio-tab-pane" data-toggle="tab">BimlStudio</a>
	                          </li>
	                                              <li class="menu-item-header direct">
	                              <a href="/BimlFlex" data-target="#bimlflex-tab-pane" data-toggle="tab">BimlFlex</a>
	                          </li>
	                                              <li class="menu-item-header direct">
	                              <a href="/BimlExpress" data-target="#bimlexpress-tab-pane" data-toggle="tab">BimlExpress</a>
	                          </li>
	                                              <li class="menu-item-header direct">
	                              <a href="/BimlOnline" data-target="#bimlonline-tab-pane" data-toggle="tab">BimlOnline</a>
	                          </li>
	                                      </ul>
	  
	                  <div class="tab-content">
	                      <div id="overview-products-tab-pane" class="tab-pane">
	                          <div class="center-content">
	                              <img src="/Content/Images/NavMenu/Product-Overview-Menu.png" class="product-menu-icon">
	                              <div class="text">
	                                  <p>Business Intelligence software for everyone.</p>
	                                  <a href="/Products">Learn More �</a>
	                              </div>
	                          </div>
	                      </div>
	                          <div id="biml-tab-pane" class="tab-pane active">
	                              <div class="center-content">
	                                  <img src="/Content/Images/NavMenu/Biml-Product-Menu.png" class="product-menu-icon">
	                                  <div class="text">
	                                      <p>Human readable and writable XML language for automating and creating business intelligence solutions.</p>
	                                      <a href="/Biml">Learn More �</a>
	                                  </div>
	                              </div>
	                          </div>
	                                              <div id="bimlstudio-tab-pane" class="tab-pane">
	                              <div class="center-content">
	                                  <img src="/Content/Images/NavMenu/BimlStudio-Product.png" class="product-menu-icon">
	                                  <div class="text">
	                                      <p>The only integrated development environment for Biml.</p>
	                                      <a href="/BimlStudio">Learn More �</a>
	                                  </div>
	                              </div>
	                          </div>
	                                              <div id="bimlflex-tab-pane" class="tab-pane">
	                              <div class="center-content">
	                                  <img src="/Content/Images/NavMenu/BimlFlex-Product-Menu.png" class="product-menu-icon">
	                                  <div class="text">
	                                      <p>A flexible and extensible framework with several extension points making it completely customizable.</p>
	                                      <a href="/BimlFlex">Learn More �</a>
	                                  </div>
	                              </div>
	                          </div>
	                                              <div id="bimlexpress-tab-pane" class="tab-pane">
	                              <div class="center-content">
	                                  <img src="/Content/Images/NavMenu/BimlExpress-Product-Menu.png" class="product-menu-icon">
	                                  <div class="text">
	                                      <p>Get more out of Visual Studio with BimlExpress. It's even fully functional with SQL Server 2016.</p>
	                                      <a href="/BimlExpress">Learn More �</a>
	                                  </div>
	                              </div>
	                          </div>
	                                              <div id="bimlonline-tab-pane" class="tab-pane">
	                              <div class="center-content">
	                                  <img src="/Content/Images/NavMenu/BimlOnline-Product-Menu.png" class="product-menu-icon">
	                                  <div class="text">
	                                      <p>The easiest way to use Biml without installing any software.</p>
	                                      <a href="/BimlOnline">Learn More �</a>
	                                  </div>
	                              </div>
	                          </div>
	                                      </div>
	              </div>
	          </div>
	      </div>
	  </li>
	  
	      <li id="supporttab" class="">
	      <a class="dropdown-link" href="/Support">Support<span class="arrow-down"><i class="fa fa-angle-down"></i></span></a>
	      <div class="menu-column-container">
	          <div id="menu-column-container-support" class="menu-container">
	  
	              <div class="mobile-menu">
	                  <ul>
	                      <li class="menu-item-header"><a href="/Support">Overview</a></li>
	                  </ul>
	                  <ul>
	                      <li class="menu-item-header submenu biml">
	                          <a class="dropdown-link">
	                              Biml
	                              <span class="arrow-down"><i class="fa fa-angle-down"></i></span>
	                          </a>
	                          <ul>
	                              <li><a href="/Documentation/Language/Index">Language Reference</a></li>
	                              <li><a href="/Documentation/Api/Index">API Reference</a></li>
	                              <li><a href="/Documentation">Snippets</a></li>
	                              <li><a class="main-menu-link" href="/Forums?forumName=Biml">Forums</a></li>
	                              <li><a href="/Training">Training</a></li>
	                          </ul>
	                      </li>
	                  </ul>
	                  <ul>
	                      <li class="menu-item-header submenu mist">
	                          <a class="dropdown-link">
	                              BimlStudio
	                              <span class="arrow-down"><i class="fa fa-angle-down"></i></span>
	                          </a>
	                          <ul>
	                              <li><a href="/Documentation/BimlStudio">User Guide</a></li>
	                              <li><a href="/Documentation/Samples/Mist">Snippets</a></li>
	                              <li><a class="main-menu-link" href="/Forums?forumName=BimlStudio">Forums</a></li>
	                              <li><a href="/Training">Training</a></li>
	                          </ul>
	                      </li>
	                  </ul>
	                  <ul>
	                      <li class="menu-item-header submenu bimlflex">
	                          <a class="dropdown-link">
	                              BimlFlex
	                              <span class="arrow-down"><i class="fa fa-angle-down"></i></span>
	                          </a>
	                          <ul>
	                              <li><a href="/Documentation/BimlFlex">User Guide</a></li>
	                              <li><a href="/Documentation/BimlFlex/Metadata">Metadata Reference</a></li>
	                              <li><a href="/Documentation/BimlFlex/ExtensionPoints">Extension Points</a></li>
	                          </ul>
	                      </li>
	                  </ul>
	  
	                  <ul>
	                      <li class="menu-item-header submenu bimlexpress">
	                          <a class="dropdown-link">
	                              BimlExpress
	                              <span class="arrow-down"><i class="fa fa-angle-down"></i></span>
	                          </a>
	                          <ul>
	                              <li><a href="/Documentation/BimlExpress">User Guide</a></li>
	                              <li><a class="main-menu-link" href="/Forums?forumName=Biml">Forums</a></li>
	                          </ul>
	                      </li>
	                  </ul>
	              </div>
	  
	              <div class="desktop-menu">
	                  <ul class="tab-control">
	                      <li class="menu-item-header direct"><a href="/Support" data-target="#overview-support-tab-pane" data-toggle="tab">Overview</a></li>
	                      <li class="menu-item-header active"><a data-target="#biml-support-tab-pane" data-toggle="tab">Biml</a></li>
	                      <li class="menu-item-header"><a data-target="#bimlstudio-support-tab-pane" data-toggle="tab">BimlStudio</a></li>
	                      <li class="menu-item-header"><a data-target="#bimlflex-support-tab-pane" data-toggle="tab">BimlFlex</a></li>
	                      <li class="menu-item-header"><a data-target="#bimlexpress-support-tab-pane" data-toggle="tab">BimlExpress</a></li>
	                  </ul>
	  
	                  <div class="tab-content">
	                      <div id="overview-support-tab-pane" class="tab-pane">
	                          <div class="right-content">
	                              <img src="/Content/Images/NavMenu/Support-Documentation-Menu.png" class="product-menu-icon">
	                              <div class="text">
	                                  <p>At Varigence, we offer a comprehensive library of professional support resources.</p>
	                                  <a href="/Products">Learn More �</a>
	                              </div>
	                          </div>
	                      </div>
	                      <div id="biml-support-tab-pane" class="tab-pane active">
	                          <div class="right-content">
	                              <img src="/Content/Images/NavMenu/Biml-Product-Menu.png" class="product-menu-icon">
	                              <div class="text">
	                                  <p>Check out our comprehensive reference materials, samples and forums.</p>
	                                  <a href="/Documentation/Language/Index">Learn More �</a>
	                              </div>
	                          </div>
	                          <ul>
	                              <li>
	                                  <a href="/Documentation/Language/Index">Language Reference</a>
	                              </li>
	                              <li>
	                                  <a href="/Documentation/Api/Index">API Reference</a>
	                              </li>
	                              <li>
	                                  <a href="/Documentation">Snippets</a>
	                              </li>
	                              <li>
	                                  <a class="main-menu-link" href="/Forums?forumName=Biml&amp;threadID=0">Forums</a>
	                              </li>
	                              <li>
	                                  <a href="/Training">Training</a>
	                              </li>
	                          </ul>
	                      </div>
	                      <div id="bimlstudio-support-tab-pane" class="tab-pane">
	                          <div class="right-content">
	                              <img src="/Content/Images/NavMenu/BimlStudio-Product.png" class="product-menu-icon">
	                              <div class="text">
	                                  <p>Check out our comprehensive reference materials and forums.</p>
	                                  <a href="/Documentation/BimlStudio">Learn More �</a>
	                              </div>
	                          </div>
	                          <ul>
	                              <li>
	                                  <a href="/Documentation/BimlStudio">User Guide</a>
	  
	                              </li>
	                              <li>
	                                  <a class="main-menu-link" href="/Forums?forumName=BimlStudio">Forums</a>
	                              </li>
	                              <li>
	                                  <a href="/Training">Training</a>
	                              </li>
	                          </ul>
	                      </div>
	                      <div id="bimlflex-support-tab-pane" class="tab-pane">
	                          <div class="right-content">
	                              <img src="/Content/Images/NavMenu/BimlFlex-Menu.png" class="product-menu-icon">
	                              <div class="text">
	                                  <p>Check out our comprehensive reference materials and forums.</p>
	                                  <a href="/Documentation/BimlStudio">Learn More �</a>
	                              </div>
	                          </div>
	                          <ul>
	                              <li>
	                                  <a href="/Documentation/BimlFlex">User Guide</a>
	                              </li>
	                              <li>
	                                  <a href="/Documentation/BimlFlex/Metadata">Metadata Reference</a>
	                              </li>
	                              <li><a href="/Documentation/BimlFlex/ExtensionPoints">Extension Points</a></li>
	  
	                          </ul>
	                      </div>
	                      <div id="bimlexpress-support-tab-pane" class="tab-pane">
	                          <div class="right-content">
	                              <img src="/Content/Images/NavMenu/BimlExpress-Product-Menu.png" class="product-menu-icon">
	                              <div class="text">
	                                  <p>Check out our comprehensive reference materials, samples and forums.</p>
	                                  <a href="/Documentation/BimlExpress">Learn More �</a>
	                              </div>
	                          </div>
	                          <ul>
	                              <li>
	                                  <a href="/Documentation/BimlExpress">User Guide</a>
	                              </li>
	                              <li>
	                                  <a class="main-menu-link" href="/Forums?forumName=Biml">Forums</a>
	                              </li>
	                          </ul>
	                      </div>
	                  </div>
	              </div>
	          </div>
	      </div>
	  </li>
	  
	      
	  
	      <li id="partnerstab" class="">
	      <a class="dropdown-link" href="/Partners">Partners<span class="arrow-down"><i class="fa fa-angle-down"></i></span></a>
	      <div class="menu-column-container">
	          <div id="menu-column-container-products" class="menu-container">
	  
	              <div class="mobile-menu">
	                  <ul>
	  
	                      <li><a href="/Partners">Consulting Partners</a></li>
	                      <li><a href="/Partners/BimlHeroes">BimlHeroes</a></li>
	  
	                  </ul>
	  
	  
	              </div>
	  
	              <div class="desktop-menu">
	                  <ul class="tab-control">
	                      
	                      <li class="menu-item-header active direct">
	                          <a href="/Partners" data-target="#partners-tab-pane" data-toggle="tab">Consulting Partners</a>
	                      </li>
	                      <li class="menu-item-header direct">
	                          <a href="/Partners/BimlHeroes" data-target="#bimlheroes-tab-pane" data-toggle="tab">BimlHeroes</a>
	                      </li>
	                  </ul>
	  
	                  <div class="tab-content">
	  
	                      <div id="partners-tab-pane" class="tab-pane active">
	                          <div class="center-content">
	                              <img src="/Content/Images/NavMenu/Partners-Consultants-Menu.png" class="product-menu-icon">
	                              <div class="text">
	                                  <p>Need Biml and BimlStudio consulting? Check out our list of Varigence partners.</p>
	                                  <a href="/Partners">Learn More �</a>
	                              </div>
	                          </div>
	                      </div>
	                      <div id="bimlheroes-tab-pane" class="tab-pane">
	                          <div class="center-content">
	                              <img src="/Content/Images/NavMenu/Partners-BimlHero-Menu.png" class="product-menu-icon">
	                              <div class="text">
	                                  <p>BimlHeroes are the only Varigence certified Biml experts.</p>
	                                  <a>Learn More �</a>
	                              </div>
	                          </div>
	                      </div>
	                  </div>
	              </div>
	          </div>
	      </div>
	  </li>
	      
	  
	      <li class=" direct"><a href="/Store">Store</a></li>
	      
	      <li class=" direct"><a href="/Blog">Blog</a></li>
	      <li id="icon-search">
	          <img class="header-search-icon" src="/Content/Images/icons/search.png">
	          <div class="search-enabled" id="search-area">
	              <div id="search-form">
	  <form action="/Search" method="get">                    <button type="submit" name="search" id="search-submit"><img src="/Content/Images/icons/search.png"></button>
	                      <input type="search" class="form-control input-sm" name="q" id="search" placeholder="Start Typing...">
	  </form>            </div>
	          </div>
	      </li>
	      <li>
	          <div class="logon-area">
	                  <div id="logon-shop">
	          <a id="logon-link">LOG IN</a>
	          <span>|</span>
	          <a href="/Account/Register">REGISTER</a>
	      </div>
	      <div id="logon-pane-triangle" class="triangle-up"></div>
	      <div id="logon-pane">
	  
	  <form action="/Account/Login" method="post" novalidate="novalidate">            <input type="hidden" name="returnUrl" value="/">
	  <input class="form-control input-sm valid" data-val="true" data-val-required="The Email field is required." id="Email" name="Email" placeholder="email" type="text" value="" aria-required="true" aria-invalid="false" aria-describedby="Email-error"><input class="form-control input-sm valid" data-val="true" data-val-required="The Password field is required." id="Password" name="Password" placeholder="password" type="password" aria-required="true" aria-invalid="false" aria-describedby="Password-error">            <input type="submit" class="btn btn-blue-white btn-standard btn-sm" value="Log In" id="logonbutton">
	              <div class="bottom-text">
	                  <span id="remember-me">Remember me?</span>
	                  <input class="check-box" data-val="true" data-val-required="The Persist field is required." id="Persist" name="Persist" type="checkbox" value="true"><input name="Persist" type="hidden" value="false">
	                  <a href="/Account/ForgotPassword" id="forgot-password-link">Forgot password?</a>
	              </div>    
	  </form>    </div>
	  
	          </div>
	      </li>
	  </ul>
	  
	              
	          </div>
	      </div>
	  </div>      <!--
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" src="../images/Varigence-Logo.png" height="46" width="46" alt="" >
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      -->
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<h4 id="mist-user-guide">Mist User Guide</h4>
<h5 id="choose-the-right-bimlscript-type">Choose the Right BimlScript Type</h5>
<p>BimlScript is useful in a variety of situations, including those that require automation (such as repetitive tasks) or where the declarative Biml model isn&#39;t sufficient; e.g. conditionally creating a column in a table.</p>
<p>Before you write a BimlScript, however, you&#39;ll first want to decide which BimlScript type is appropriate for your task.</p>
<p>There are three BimlScript types to choose from:</p>
<ol>
<li>Executable</li>
<li>Live</li>
<li>Transformers</li>
</ol>
<p>This article explains each type, enabling you to choose the right type for your needs.</p>
<h4 id="executable">Executable</h4>
<p><strong>Trigger:</strong>
On Demand:</p>
<p><strong>Description:</strong>
Executable BimlScript is BimlScript that is applied to a Mist project on-demand. Executable BimlScripts are created by adding BimlScript assets to a Mist project; these assets are listed in the logical view&#39;s BimlScript Library group. An executable BimlScript can be authored in Mist&#39;s BimlScript editor; the BimlScript&#39;s results can be previewed within the editor too. When the BimlScript is error free, you can press the ribbon&#39;s Expand button to compile and execute the BimlScript. This results in any assets, created by the executable BimlScript, being immediately added to your Mist project.</p>
<p><strong>Example Creating New Objects:</strong>
Our <a href="http://www.varigence.com/documentation/mist/018_ImportingTablesWithBimlScript.htm">Importing Tables With BimlScript</a> example demonstrates executable BimlScript. Each time you press the Expand button, the BimlScript is compiled and any .NET code is executed. All assets generated by the code are then added to your project. From there, you can alter them however you wish, as if you had manually created each one.
<img src="https://varigencecom.blob.core.windows.net/images-mistdocumentation/230_LADBimlScriptEditor.png" alt="Late Arriving Dimension in BimlScript editor"></p>
<p>To demonstrate this, consider a project that has an ETL package with a couple of Lookup components. We want to update each Lookup to handle Late Arriving Dimension logic. To accomplish this, we need a way to define the Lookups in Packages that already exist.</p>
<p>An executable BimlScript, that inserts Late Arriving Dimension logic, might look like this:</p>
<pre><code>&lt;#@ template language=&quot;C#&quot; hostspecific=&quot;True&quot; mergemode=&quot;LocalReplace&quot;#&gt;
&lt;#@ target type=&quot;Lookup&quot; #&gt;

&lt;# if (TargetNode.Annotations[&quot;LateArriving&quot;] != null) { #&gt;
&lt;Transformations&gt;
    &lt;#=TargetNode.EmitAllXml()#&gt;
    &lt;DerivedColumns Name=&quot;_&lt;#=TargetNode.Name#&gt;_DerivedColumnsDefaultValue&quot;&gt;
        &lt;InputPath OutputPathName=&quot;&lt;#=TargetNode.Name#&gt;.NoMatch&quot; /&gt;
        &lt;Columns&gt;
            &lt;Column Name=&quot;&lt;#=TargetNode.Annotations[&quot;LateArriving&quot;].Text#&gt;&quot; DataType=&quot;Int32&quot;&gt;0&lt;/Column&gt;
        &lt;/Columns&gt;
    &lt;/DerivedColumns&gt;
    &lt;OleDbCommand Name=&quot;_&lt;#=TargetNode.Name#&gt;_OleDBCommandInsertPlaceholderRow&quot; ConnectionName=&quot;DataWarehouse&quot;
        ValidateExternalMetadata=&quot;False&quot;&gt;
        &lt;DirectInput&gt;EXEC pInsertCustomer ?, ? OUTPUT&lt;/DirectInput&gt;
        &lt;Parameters&gt;
            &lt;Parameter SourceColumn=&quot;Customer&quot; TargetColumn=&quot;@CustomerName&quot; /&gt;
            &lt;Parameter SourceColumn=&quot;SalesAmount&quot; TargetColumn=&quot;@CustomerID&quot; /&gt;
        &lt;/Parameters&gt;
    &lt;/OleDbCommand&gt;
    &lt;UnionAll Name=&quot;_&lt;#=TargetNode.Name#&gt;_UnionAllMatchAndNoMatch&quot;&gt;
        &lt;InputPaths&gt;
            &lt;InputPath OutputPathName=&quot;&lt;#=TargetNode.Name#&gt;.Match&quot; /&gt;
            &lt;InputPath OutputPathName=&quot;_&lt;#=TargetNode.Name#&gt;_OleDBCommandInsertPlaceholderRow.Output&quot; /&gt;
        &lt;/InputPaths&gt;
    &lt;/UnionAll&gt;
&lt;/Transformations&gt;
&lt;# } #&gt;
</code></pre><p>The first thing to notice is that the Biml portion doesn&#39;t start with a Biml tag; it begins with a Transformations tag instead. This BimlScript fragment, that doesn&#39;t begin with a Biml tag, is called a <em>partial</em> BimlScript. Partial BimlScripts are used to merge changes into existing Biml assets. Only Executable and Transformer BimlScripts support partial BimlScript.</p>
<p>This partial BimlScript generates a Biml fragment that will be inserted into existing nodes. The type of node that will be edited is of type Lookup, which is set in the target type directive at the top of the script. When this partial BimlScript is executed via the ribbon&#39;s Expand button, it will be applied to all Lookup nodes in the project, inserting the Transformations collection that&#39;s specified in the script.</p>
<p>By specifying a target type, BimlScripts gain access to a built-in TargetNode property. When a BimlScript is executed, it&#39;s run on each node in the project whose type matches the target type. The TargetNode property contains the node that the BimlScript is being run on. This enables a BimlScript author to set conditionals based on the properties on a node; in the above example, there&#39;s an if statement that checks if the TargetNode&#39;s Annotations collection holds an annotation named &#39;LateArriving&#39;. This capability enables fine grained control of the specific nodes that will be modified by a BimlScript.</p>
<h4 id="live">Live</h4>
<p><strong>Trigger:</strong>
Project Changes</p>
<p><strong>Description:</strong>
Live BimlScript is BimlScript that&#39;s placed within a regular Biml file. This causes the BimlScript-generated objects to become &#39;live&#39; objects. They are compiled and executed whenever there are changes to the project. Thus, assets generated by live BimlScript are always up-to-date. Because they are re-generated by any change, however, they can&#39;t be altered within Mist visual designers; changes must be made to the live BimlScript itself, using the Biml editor.</p>
<p><strong>Example Creating New Objects</strong>
One common use of live BimlScript is automatically generating Biml code within a Biml file. For instance, the <a href="http://www.varigence.com/samples/mist/federal-reserve#buildDataPackage">Federal Reserver sample</a> demonstrates live BimlScript in the LoadDimDate package. Within this package is an ExecuteSQL task that needs to insert all dates, from January 1<sup>st</sup> 1900 to December 31<sup>st</sup> 1979, into a Date dimension. Rather than generating the dates in another tool and copy/pasting them into the editor, live BimlScript is used. A simple for loop iterates over the range of dates, adding an INSERT INTO statement for each. This is particularly powerful if you ever need to change the date range; a one line change to enter the new date causes the live BimlScript to immediately re-run, generating the updated dates in the SQL query. </p>
<p>Of course, live BimlScript can also be used to generate Biml assets.</p>
<pre><code>&lt;#@ template language=&quot;C#&quot; hostspecific=&#39;true&#39;#&gt;
&lt;#@ import namespace=&quot;System.Data&quot; #&gt;

&lt;Biml xmlns=&quot;http://schemas.varigence.com/biml.xsd&quot;&gt;
    &lt;Connections&gt;
        &lt;OleDbConnection Name=&#39;Source&#39; ConnectionString=&#39;Provider=SQLNCLI10;Server=.;
            Initial Catalog=AdventureWorksDW2008R2;Integrated Security=SSPI;&#39;/&gt;
    &lt;/Connections&gt;
    &lt;Packages&gt;
        &lt;Package Name=&#39;Rebuild Warehouse Data&#39; ConstraintMode=&#39;Linear&#39; AutoCreateConfigurationsType=&quot;None&quot;&gt;
            &lt;Tasks&gt;
                &lt;# foreach (var table in RootNode.Tables) 
                { 
                    if (!table.Schema.Name == &#39;dbo&#39;)
                    {
                    #&gt;
                        &lt;Dataflow Name=&quot;Copy Data&quot; &lt;#=table.Name#&gt;&gt;
                            &lt;Transformations&gt;
                                &lt;OleDbSource Name=&quot;Retrieve Data&quot; ConnectionName=&quot;Source&quot;&gt;
                                    &lt;DirectInput&gt;SELECT * FROM &lt;#=table.Name#&gt;&lt;/DirectInput&gt;
                                &lt;/OleDbSource&gt;
                                &lt;OleDbDestination Name=&quot;Insert Data&quot; ConnectionName=&quot;Target&quot;&gt;
                                &lt;ExternalTableOutput Table=&quot;&lt;#=table.Name#&gt;&quot;/&gt;
                                &lt;OleDbDestination&gt;
                            &lt;/Transformations&gt;
                    &lt;/Dataflow&gt;
                    &lt;# }
                } #&gt;
            &lt;/Tasks&gt;
        &lt;/Package&gt;
    &lt;/Packages&gt;
&lt;/Biml&gt;
</code></pre><p>In this example, a new Dataflow task is created for each table in a project that is not in the dbo schema. Each Dataflow task retrieves a table&#39;s data from a Source connection and copies that data to a Target connection. This illustrates that BimlScript can take advantage of conditionals like any .NET code.</p>
<p><img src="https://varigencecomstaging.blob.core.windows.net/images-mistdocumentation/230_RebuildWarehouseDataPackage.png" alt="Rebuild Warehouse Data package"></p>
<p>If the above sample had been applied as executable BimlScript, and new tables were added in the project, Dataflow tasks for those tables wouldn&#39;t be automatically added to the package. This illustrates the key difference between executable vs. live BimlScript: one-time generation of editable assets vs. always up-to-date and un-editable assets.</p>
<h4 id="transformers">Transformers</h4>
<p><strong>Trigger:</strong>
Build</p>
<p><strong>Description</strong></p>
<p>The final type of BimlScript is a transformer. Transformers are BimlScripts whose changes are only applied when building a project, instead of the changes being applied within Mist.</p>
<p><strong>Example:</strong>
One scenario where transformers are useful is when an architect wants to apply a specific pattern to Biml assets used within a project, or even across multiple projects. For instance, perhaps there&#39;s a logging pattern that should be applied to all packages. The architect can author the pattern in a transformer within Mist, letting him leverage intelliprompt and the BimlScript editor&#39;s preview pane. However, instead of executing it in Mist (which would only apply it to the current set of packages), he can add a command line option to the project to execute the transformer&#39;s Biml file during a build:</p>
<p>--transformationScriptSettings &lt;path to ScriptSettings 
file&gt; <em>the ScriptSettings file contains a path to the BimlScript file</em></p>
<p>When another developer builds the project, the logging pattern is applied to all of his project&#39;s packages automatically. Even better, if the pattern needs to be updated in the future, the architect can make the appropriate change and any developer can apply it just by rebuilding his project.</p>
<p>Transformers allow architects to worry about enforcing patterns and best practices, while other developers focus on the business logic. Additionally, transformers make it easy to change patterns over time by not altering the Biml files on disk.</p>
<h4 id="conclusion">Conclusion</h4>
<p>As discussed, the three types of BimlScript enable a wide range of development scenarios. Additionally, partial BimlScripts empower you to merge changes into existing Biml assets.</p>
<p>This chart summarizes the three types of BimlScript and their key differences. Refer to it as you begin leveraging BimlScript so you can choose the right type for your scenario.</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Main Purpose</th>
<th>Triggered By</th>
<th>Where Defined</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Executable</strong></td>
<td>Producing one-time assets that can then be edited further.</td>
<td>Expand button</td>
<td>BimlScript Library</td>
</tr>
<tr>
<td><strong>Live</strong></td>
<td>Producing always up-to-date assets (that can&#39;t be manually changed).</td>
<td>Any project change; always running.</td>
<td>Within any Biml file.</td>
</tr>
<tr>
<td><strong>Transformer</strong></td>
<td>Enforcing development patterns during builds.</td>
<td>Build</td>
<td>BimlScript Library &amp; Plugins</td>
</tr>
</tbody>
</table>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/varigence/docs/blob/master/proj2/articles/Choose The Right Script Mode.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
      <div id="footer-wrapper" style="margin-top: 30px;">
      <div id="footerCap"></div>
      <div id="footer">
      <div class="product-section">
          <div class="inner-container">
              <div id="subscribe-wrapper">
                  <div id="subscribe">
                      <h3 class="join-now-copy">Join our newsletter to<br> stay up with the latest<br> product releases!</h3>
                      <div class="clearfix">
                          <div class="join-now-form">
                              <img alt="Loading..." src="/Content/Images/Loaders/orange-loader.gif" style="display: none" id="mailchimp-loader">
                              <input id="subscribe-textbox" type="email" title="Enter your email address here and click submit to subscribe to our news letter." placeholder="Email Address" class="form-control">
                              <button id="subscribe-button" class="btn btn-blue-white" title="Enter your email address and click here to subscribe to our news letter" data-loading-text="Subscribing">Subscribe</button>
                          </div>
                      </div>
                      <span style="display: none;" id="subscribe-success">Thank you! You should be receiving a confirmation email shortly.</span>
                      <span style="display: none; color: red;" id="subscribe-error">Error subscribing. Please try again.</span>
                      <div class="social">
                          <p>You can follow us here too!</p>
                          <a href="https://www.facebook.com/varigence" target="_blank"><i class="fa fa-facebook"></i></a>
                          <a href="https://twitter.com/varigence" target="_blank"><i class=" fa fa-twitter"></i></a>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      <div class="product-section">
          <div class="inner-container">
              <div class="container">
                  <div class="row">
                      <div class="col-sm-3">
                          <ul>
                              <li>Products</li>
                              <li><a href="/Products">Products</a></li>
                                  <li><a href="/Biml">Biml</a></li>
                                                          <li><a href="/Mist">BimlStudio</a></li>
                                                          <li><a href="/BimlFlex">BimlFlex</a></li>
                                                          <li><a href="/BimlExpress">BimlExpress</a></li>
                                                          <li><a href="/BimlOnline">BimlOnline</a></li>
                                                  </ul>
                      </div>
                      <div class="col-sm-3">
                          <ul>
                              <li>Company</li>
                              <li><a href="/Company">About Us</a></li>
                              <li><a href="/Partners">Partners</a></li>
                              <li><a href="/Blog">Blog</a></li>
                              <li><a href="/Store">Store</a></li>
                              <li><a href="/Support">Support</a></li>
                          </ul>
                      </div>
                      <div class="col-sm-3">
                          <ul>
                              <li>Legal</li>
                              <li><a href="/Documentation/Legal/PrivacyPolicy">Privacy Policy</a></li>
                              <li><a href="/Documentation/Legal/TermsOfUse">Terms of Use</a></li>
                          </ul>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      <div class="product-section">
          <div class="inner-container">
              <p style="font-size: 12px; padding: 10px 0;">Copyright © Varigence 2017</p>
          </div>
      </div>
      </div>
      </div>
      </footer>
    </div>
    
    <!--[if gte IE 9]><!-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    
    <!--<![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
